

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TGAN &mdash; TGAN 0.1.1-dev documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/dai-logo-white.ico"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="tgan package" href="api/tgan.html" />
    <link rel="prev" title="TGAN" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> TGAN
          

          
            
            <img src="_static/dai-logo-white-200.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">TGAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="#requirements">Requirements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#python">Python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#data-format">Data Format</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#input-format">Input Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#output-format">Output Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#demo-datasets">Demo Datasets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#census-dataset">Census dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cover-type">Cover type</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#quickstart">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#load-the-data">1. Load the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-a-tgan-instance">2. Create a TGAN instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fit-the-model">3. Fit the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sample-new-data">4. Sample new data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#save-and-load-a-model">5. Save and Load a model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#loading-custom-datasets">Loading custom datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="#model-parameters">Model Parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#model-general-behavior">Model general behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="#neural-network-definition-and-fitting">Neural network definition and fitting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#command-line-interface">Command-line interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#random-hyperparameter-search">Random hyperparameter search</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#input">Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="#execution">Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output">Output</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#research">Research</a></li>
<li class="toctree-l1"><a class="reference internal" href="#what-s-next">What’s next?</a></li>
<li class="toctree-l1"><a class="reference internal" href="#citing-tgan">Citing TGAN</a></li>
</ul>
<p class="caption"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/tgan.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/tgan.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/tgan.research.html">tgan.research package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="api/tgan.research.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/tgan.html#submodules">Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/tgan.cli.html">tgan.cli module</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/tgan.data.html">tgan.data module</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/tgan.model.html">tgan.model module</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/tgan.trainer.html">tgan.trainer module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#types-of-contributions">Types of Contributions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#report-bugs">Report Bugs</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#fix-bugs">Fix Bugs</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#implement-features">Implement Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#write-documentation">Write Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#submit-feedback">Submit Feedback</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#get-started">Get Started!</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#pull-request-guidelines">Pull Request Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#unit-testing-guidelines">Unit Testing Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#tips">Tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#release-workflow">Release Workflow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a><ul>
<li class="toctree-l2"><a class="reference internal" href="authors.html#contributors">Contributors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a><ul>
<li class="toctree-l2"><a class="reference internal" href="history.html#id1">0.1.0</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TGAN</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>TGAN</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/sdv-dev/TGAN/blob/master/docs/readme.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p align="left">
<img width=20% src="https://dai.lids.mit.edu/wp-content/uploads/2018/06/Logo_DAI_highres.png" alt="sdv-dev" />
<i>An open source project from Data to AI Lab at MIT.</i>
</p><a class="reference external image-reference" href="https://pypi.python.org/pypi/TGAN"><img alt="PyPi Shield" src="https://img.shields.io/pypi/v/TGAN.svg" /></a>
<a class="reference external image-reference" href="https://travis-ci.org/sdv-dev/TGAN"><img alt="Travis CI Shield" src="https://travis-ci.org/sdv-dev/TGAN.svg?branch=master" /></a>
<a class="reference external image-reference" href="https://codecov.io/gh/sdv-dev/TGAN"><img alt="CodeCov" src="https://codecov.io/gh/sdv-dev/TGAN/branch/master/graph/badge.svg" /></a>
<a class="reference external image-reference" href="https://pepy.tech/project/tgan"><img alt="Downloads" src="https://pepy.tech/badge/tgan" /></a>
<p><strong>We are happy to announce that our new model for synthetic data called `CTGAN &lt;https://github.com/sdv-dev/CTGAN&gt;`_ is open-sourced. Please check the new model in `this repo &lt;https://github.com/sdv-dev/CTGAN&gt;`_. The new model is simpler and gives better performance on many datasets.</strong></p>
<div class="section" id="tgan">
<h1>TGAN<a class="headerlink" href="#tgan" title="Permalink to this headline">¶</a></h1>
<p>Generative adversarial training for synthesizing tabular data.</p>
<ul class="simple">
<li><p>License: <a class="reference external" href="https://github.com/sdv-dev/TGAN/blob/master/LICENSE">MIT</a></p></li>
<li><p>Documentation: <a class="reference external" href="https://sdv-dev.github.io/TGAN">https://sdv-dev.github.io/TGAN</a></p></li>
<li><p>Homepage: <a class="reference external" href="https://github.com/sdv-dev/TGAN">https://github.com/sdv-dev/TGAN</a></p></li>
</ul>
</div>
<div class="section" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<p>TGAN is a tabular data synthesizer. It can generate fully synthetic data from real data. Currently, TGAN can
generate numerical columns and categorical columns.</p>
</div>
<div class="section" id="requirements">
<h1>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h1>
<div class="section" id="python">
<h2>Python<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h2>
<p><strong>TGAN</strong> has been developed and runs on Python <a class="reference external" href="https://www.python.org/downloads/release/python-356/">3.5</a>,
<a class="reference external" href="https://www.python.org/downloads/release/python-360/">3.6</a> and
<a class="reference external" href="https://www.python.org/downloads/release/python-370/">3.7</a>.</p>
<p>Also, although it is not strictly required, the usage of a <a class="reference external" href="https://virtualenv.pypa.io/en/latest/">virtualenv</a>
is highly recommended in order to avoid interfering with other software installed in the system where <strong>TGAN</strong>
is run.</p>
</div>
</div>
<div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>The simplest and recommended way to install TGAN is using <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>pip install tgan
</pre></div>
</div>
<p>Alternatively, you can also clone the repository and install it from sources</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>git clone git@github.com:sdv-dev/TGAN.git
cd TGAN
make install
</pre></div>
</div>
<p>For development, you can use <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">install-develop</span></code> instead in order to install all the required
dependencies for testing and code linting.</p>
</div>
<div class="section" id="data-format">
<h1>Data Format<a class="headerlink" href="#data-format" title="Permalink to this headline">¶</a></h1>
<div class="section" id="input-format">
<h2>Input Format<a class="headerlink" href="#input-format" title="Permalink to this headline">¶</a></h2>
<p>In order to be able to sample new synthetic data, <strong>TGAN</strong> first needs to be <em>fitted</em> to
existing data.</p>
<p>The input data for this <em>fitting</em> process has to be a single table that satisfies the following
rules:</p>
<ul class="simple">
<li><p>Has no missing values.</p></li>
<li><p>Has columns of types <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code> or <code class="docutils literal notranslate"><span class="pre">bool</span></code>.</p></li>
<li><p>Each column contains data of only one type.</p></li>
</ul>
<p>An example of such a tables would be:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>str_column</p></th>
<th class="head"><p>float_column</p></th>
<th class="head"><p>int_column</p></th>
<th class="head"><p>bool_column</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘green’</p></td>
<td><p>0.15</p></td>
<td><p>10</p></td>
<td><p>True</p></td>
</tr>
<tr class="row-odd"><td><p>‘blue’</p></td>
<td><p>7.25</p></td>
<td><p>23</p></td>
<td><p>False</p></td>
</tr>
<tr class="row-even"><td><p>‘red’</p></td>
<td><p>10.00</p></td>
<td><p>1</p></td>
<td><p>False</p></td>
</tr>
<tr class="row-odd"><td><p>‘yellow’</p></td>
<td><p>5.50</p></td>
<td><p>17</p></td>
<td><p>True</p></td>
</tr>
</tbody>
</table>
<p>As you can see, this table contains 4 columns: <code class="docutils literal notranslate"><span class="pre">str_column</span></code>, <code class="docutils literal notranslate"><span class="pre">float_column</span></code>, <code class="docutils literal notranslate"><span class="pre">int_column</span></code> and
<code class="docutils literal notranslate"><span class="pre">bool_column</span></code>, each one being an example of the supported value types. Notice aswell that there is
no missing values for any of the rows.</p>
<p><strong>NOTE</strong>: It’s important to have properly identifed which of the columns are numerical, which means
that they represent a magnitude, and which ones are categorical, as during the preprocessing of
the data, numerical and categorical columns will be processed differently.</p>
</div>
<div class="section" id="output-format">
<h2>Output Format<a class="headerlink" href="#output-format" title="Permalink to this headline">¶</a></h2>
<p>The output of <strong>TGAN</strong> is a table of sampled data with the same columns as the input table and as
many rows as requested.</p>
</div>
<div class="section" id="demo-datasets">
<h2>Demo Datasets<a class="headerlink" href="#demo-datasets" title="Permalink to this headline">¶</a></h2>
<p><strong>TGAN</strong> includes a few datasets to use for development or demonstration purposes. These datasets
come from the <a class="reference external" href="http://archive.ics.uci.edu/ml">UCI Machine Learning repository</a>, and have been
preprocessed to be ready to use with <strong>TGAN</strong>, following the requirements specified in the
<a class="reference external" href="#input-format">Input Format</a> section.</p>
<p>These datasets can be browsed and directly downloaded from the
<a class="reference external" href="http://hdi-project-tgan.s3.amazonaws.com/index.html">hdi-project-tgan AWS S3 Bucket</a></p>
<div class="section" id="census-dataset">
<h3>Census dataset<a class="headerlink" href="#census-dataset" title="Permalink to this headline">¶</a></h3>
<p>This dataset contains a single table, with information from the census, labeled with information of
wheter or not the income of is greater than 50.000 $/year. It’s a single csv file, containing
199522 rows and 41 columns. From these 41 columns, only 7 are identified as continuous. In
<strong>TGAN</strong> this dataset is called <code class="docutils literal notranslate"><span class="pre">census</span></code>.</p>
</div>
<div class="section" id="cover-type">
<h3>Cover type<a class="headerlink" href="#cover-type" title="Permalink to this headline">¶</a></h3>
<p>This dataset contains a single table with cartographic information labeled with the different
forrest cover types. It’s a single csv file, containing 465588 rows and 55 columns. From these
55 columns, 10 are identified as continuous. In <strong>TGAN</strong> this dataset is called <code class="docutils literal notranslate"><span class="pre">covertype</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="quickstart">
<h1>Quickstart<a class="headerlink" href="#quickstart" title="Permalink to this headline">¶</a></h1>
<p>In this short tutorial we will guide you through a series of steps that will help you getting
started with the most basic usage of <strong>TGAN</strong> in order to generate samples from a given dataset.</p>
<p><strong>NOTE</strong>: The following examples are also covered in a <a class="reference external" href="https://jupyter.org/">Jupyter</a> notebook,
which you can execute by running the following commands inside your <em>virtualenv</em>:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>pip install jupyter
jupyter notebook examples/Usage_Example.ipynb
</pre></div>
</div>
<div class="section" id="load-the-data">
<h2>1. Load the data<a class="headerlink" href="#load-the-data" title="Permalink to this headline">¶</a></h2>
<p>The first step is to load the data wich we will use to fit TGAN. In order to do so, we will first
import the function <code class="docutils literal notranslate"><span class="pre">tgan.data.load_data</span></code> and call it with the name of the dataset that we want to
load.</p>
<p>In this case, we will load the <code class="docutils literal notranslate"><span class="pre">census</span></code> dataset, which we will use during the subsequent steps,
and obtain two objects:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code>, that will contain a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with the table of data from the <code class="docutils literal notranslate"><span class="pre">census</span></code>
dataset ready to be used to fit the model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">continuous_columns</span></code>, that will contain a <code class="docutils literal notranslate"><span class="pre">list</span></code> with the indices of continuous columns.</p></li>
</ol>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; from tgan.data import load_demo_data
&gt;&gt;&gt; data, continuous_columns = load_demo_data(&#39;census&#39;)
&gt;&gt;&gt; data.head(3).T[:10]
                              0                                     1                             2
0                            73                                    58                            18
1               Not in universe        Self-employed-not incorporated               Not in universe
2                             0                                     4                             0
3                             0                                    34                             0
4          High school graduate            Some college but no degree                    10th grade
5                             0                                     0                             0
6               Not in universe                       Not in universe                   High school
7                       Widowed                              Divorced                 Never married
8   Not in universe or children                          Construction   Not in universe or children
9               Not in universe   Precision production craft &amp; repair               Not in universe

&gt;&gt;&gt; continuous_columns
[0, 5, 16, 17, 18, 29, 38]
</pre></div>
</div>
</div>
<div class="section" id="create-a-tgan-instance">
<h2>2. Create a TGAN instance<a class="headerlink" href="#create-a-tgan-instance" title="Permalink to this headline">¶</a></h2>
<p>The next step is to import TGAN and create an instance of the model.</p>
<p>To do so, we need to import the <code class="docutils literal notranslate"><span class="pre">tgan.model.TGANModel</span></code> class and call it with the
<code class="docutils literal notranslate"><span class="pre">continuous_columns</span></code> as unique argument.</p>
<p>This will create a TGAN instance with the default parameters:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; from tgan.model import TGANModel
&gt;&gt;&gt; tgan = TGANModel(continuous_columns)
</pre></div>
</div>
</div>
<div class="section" id="fit-the-model">
<h2>3. Fit the model<a class="headerlink" href="#fit-the-model" title="Permalink to this headline">¶</a></h2>
<p>Once you have a <strong>TGAN</strong> instance, you can proceed to call it’s <code class="docutils literal notranslate"><span class="pre">fit</span></code> method passing the <code class="docutils literal notranslate"><span class="pre">data</span></code> that
you loaded before in order to start the fitting process:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; tgan.fit(data)
</pre></div>
</div>
<p>This process will not return anything, however, the progress of the fitting will be printed in the
screen.</p>
<p><strong>NOTE</strong> Depending on the performance of the system you are running, and the parameters selected
for the model, this step can take up to a few hours.</p>
</div>
<div class="section" id="sample-new-data">
<h2>4. Sample new data<a class="headerlink" href="#sample-new-data" title="Permalink to this headline">¶</a></h2>
<p>After the model has been fitted, you are ready to generate new samples by calling the <code class="docutils literal notranslate"><span class="pre">sample</span></code>
method of the <code class="docutils literal notranslate"><span class="pre">TGAN</span></code> instance passing it the desired amount of samples:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; num_samples = 1000
&gt;&gt;&gt; samples = tgan.sample(num_samples)
&gt;&gt;&gt; samples.head(3).T[:10]
                                         0                                     1                                   2
0                                       12                                    27                                  56

0                                       12                                    27                                  56
1                          Not in universe        Self-employed-not incorporated                             Private
2                                        0                                     4                                  35
3                                        0                                    34                                  22
4                                 Children            Some college but no degree          Some college but no degree
5                                        0                                     0                                 500
6                          Not in universe                       Not in universe                     Not in universe
7                            Never married       Married-civilian spouse present     Married-civilian spouse present
8              Not in universe or children                          Construction   Finance insurance and real estate
9                          Not in universe   Precision production craft &amp; repair      Adm support including clerical
</pre></div>
</div>
<p>The returned object, <code class="docutils literal notranslate"><span class="pre">samples</span></code>, is a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> containing a table of synthetic data with
the same format as the input data and 1000 rows as we requested.</p>
</div>
<div class="section" id="save-and-load-a-model">
<h2>5. Save and Load a model<a class="headerlink" href="#save-and-load-a-model" title="Permalink to this headline">¶</a></h2>
<p>In the steps above we saw that the fitting process can take a lot of time, so we probably would
like to avoid having to fit every we want to generate samples. Instead we can fit a model once,
save it, and load it every time we want to sample new data.</p>
<p>If we have a fitted model, we can save it by calling it’s <code class="docutils literal notranslate"><span class="pre">save</span></code> method, that only takes
as argument the path where the model will be stored. Similarly, the <code class="docutils literal notranslate"><span class="pre">TGANModel.load</span></code> allows to load
a model stored on disk by passing as argument the path where the model is stored.</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; model_path = &#39;models/mymodel.pkl&#39;
&gt;&gt;&gt; tgan.save(model_path)
Model saved successfully.
</pre></div>
</div>
<p>Bear in mind that in case the file already exists, <strong>TGAN</strong> will avoid overwritting it unless the
<code class="docutils literal notranslate"><span class="pre">force=True</span></code> argument is passed:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; tgan.save(model_path)
The indicated path already exists. Use `force=True` to overwrite.
</pre></div>
</div>
<p>In order to do so:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; tgan.save(model_path, force=True)
Model saved successfully.
</pre></div>
</div>
<p>Once the model is saved, it can be loaded back as a <strong>TGAN</strong> instance by using the <code class="docutils literal notranslate"><span class="pre">TGANModel.load</span></code>
method:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; new_tgan = TGANModel.load(model_path)
&gt;&gt;&gt; new_samples = new_tgan.sample(num_samples)
&gt;&gt;&gt; new_samples.head(3).T[:10]

                                         0                                     1                                   2
0                                       12                                    27                                  56

0                                       12                                    27                                  56
1                          Not in universe        Self-employed-not incorporated                             Private
2                                        0                                     4                                  35
3                                        0                                    34                                  22
4                                 Children            Some college but no degree          Some college but no degree
5                                        0                                     0                                 500
6                          Not in universe                       Not in universe                     Not in universe
7                            Never married       Married-civilian spouse present     Married-civilian spouse present
8              Not in universe or children                          Construction   Finance insurance and real estate
9                          Not in universe   Precision production craft &amp; repair      Adm support including clerical
</pre></div>
</div>
<p>At this point we could use this model instance to generate more samples.</p>
</div>
</div>
<div class="section" id="loading-custom-datasets">
<h1>Loading custom datasets<a class="headerlink" href="#loading-custom-datasets" title="Permalink to this headline">¶</a></h1>
<p>In the previous steps we used some demonstration data but we did not show you how to load your own
dataset.</p>
<p>In order to do so you will need to generate a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> object from your dataset. If your
dataset is in a <code class="docutils literal notranslate"><span class="pre">csv</span></code> format you can do so by using <code class="docutils literal notranslate"><span class="pre">pandas.read_csv</span></code> and passing to it the path to
the CSV file that you want to load.</p>
<p>Additionally, you will need to create 0-indexed list of columns indices to be considered continuous.</p>
<p>For example, if we want to load a local CSV file, <code class="docutils literal notranslate"><span class="pre">path/to/my.csv</span></code>, that has as continuous columns
their first 4 columns, that is, indices <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code>, we would do it like this:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; import pandas as pd
&gt;&gt;&gt; data = pd.read_csv(&#39;data/census.csv&#39;)
&gt;&gt;&gt; continuous_columns = [0, 1, 2, 3]
</pre></div>
</div>
<p>Now you can use the <code class="docutils literal notranslate"><span class="pre">continuous_columns</span></code> to create a <strong>TGAN</strong> instance and use the <code class="docutils literal notranslate"><span class="pre">data</span></code> to <code class="docutils literal notranslate"><span class="pre">fit</span></code>
it, like we did before:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; from tgan.model import TGANModel
&gt;&gt;&gt; tgan = TGANModel(continuous_columns)
&gt;&gt;&gt; tgan.fit(data)
</pre></div>
</div>
</div>
<div class="section" id="model-parameters">
<h1>Model Parameters<a class="headerlink" href="#model-parameters" title="Permalink to this headline">¶</a></h1>
<p>If you want to change the default behavior of <code class="docutils literal notranslate"><span class="pre">TGANModel</span></code>, such as as different <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> or
<code class="docutils literal notranslate"><span class="pre">num_epochs</span></code>, you can do so by passing different arguments when creating the instance.</p>
<div class="section" id="model-general-behavior">
<h2>Model general behavior<a class="headerlink" href="#model-general-behavior" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>continous_columns (<code class="docutils literal notranslate"><span class="pre">list[int]</span></code>, required): List of columns indices to be considered continuous.</p></li>
<li><p>output (<code class="docutils literal notranslate"><span class="pre">str</span></code>, default=<code class="docutils literal notranslate"><span class="pre">output</span></code>): Path to store the model and its artifacts.</p></li>
</ul>
</div>
<div class="section" id="neural-network-definition-and-fitting">
<h2>Neural network definition and fitting<a class="headerlink" href="#neural-network-definition-and-fitting" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>max_epoch (<code class="docutils literal notranslate"><span class="pre">int</span></code>, default=<code class="docutils literal notranslate"><span class="pre">100</span></code>): Number of epochs to use during training.</p></li>
<li><p>steps_per_epoch (<code class="docutils literal notranslate"><span class="pre">int</span></code>, default=<code class="docutils literal notranslate"><span class="pre">10000</span></code>): Number of steps to run on each epoch.</p></li>
<li><p>save_checkpoints(<code class="docutils literal notranslate"><span class="pre">bool</span></code>, default=True): Whether or not to store checkpoints of the model after each training epoch.</p></li>
<li><p>restore_session(<code class="docutils literal notranslate"><span class="pre">bool</span></code>, default=True): Whether or not continue training from the last checkpoint.</p></li>
<li><p>batch_size (<code class="docutils literal notranslate"><span class="pre">int</span></code>, default=<code class="docutils literal notranslate"><span class="pre">200</span></code>): Size of the batch to feed the model at each step.</p></li>
<li><p>z_dim (<code class="docutils literal notranslate"><span class="pre">int</span></code>, default=<code class="docutils literal notranslate"><span class="pre">100</span></code>): Number of dimensions in the noise input for the generator.</p></li>
<li><p>noise (<code class="docutils literal notranslate"><span class="pre">float</span></code>, default=<code class="docutils literal notranslate"><span class="pre">0.2</span></code>): Upper bound to the gaussian noise added to categorical columns.</p></li>
<li><p>l2norm (<code class="docutils literal notranslate"><span class="pre">float</span></code>, default=<code class="docutils literal notranslate"><span class="pre">0.00001</span></code>): L2 reguralization coefficient when computing losses.</p></li>
<li><p>learning_rate (<code class="docutils literal notranslate"><span class="pre">float</span></code>, default=<code class="docutils literal notranslate"><span class="pre">0.001</span></code>): Learning rate for the optimizer.</p></li>
<li><p>num_gen_rnn (<code class="docutils literal notranslate"><span class="pre">int</span></code>, default=<code class="docutils literal notranslate"><span class="pre">400</span></code>): Number of units in rnn cell in generator.</p></li>
<li><p>num_gen_feature (<code class="docutils literal notranslate"><span class="pre">int</span></code>, default=<code class="docutils literal notranslate"><span class="pre">100</span></code>): Number of units in fully connected layer in generator.</p></li>
<li><p>num_dis_layers (<code class="docutils literal notranslate"><span class="pre">int</span></code>, default=<code class="docutils literal notranslate"><span class="pre">2</span></code>): Number of layers in discriminator.</p></li>
<li><p>num_dis_hidden (<code class="docutils literal notranslate"><span class="pre">int</span></code>, default=<code class="docutils literal notranslate"><span class="pre">200</span></code>): Number of units per layer in discriminator.</p></li>
<li><p>optimizer (<code class="docutils literal notranslate"><span class="pre">str</span></code>, default=<code class="docutils literal notranslate"><span class="pre">AdamOptimizer</span></code>): Name of the optimizer to use during <code class="docutils literal notranslate"><span class="pre">fit</span></code>, possible
values are: [<code class="docutils literal notranslate"><span class="pre">GradientDescentOptimizer</span></code>, <code class="docutils literal notranslate"><span class="pre">AdamOptimizer</span></code>, <code class="docutils literal notranslate"><span class="pre">AdadeltaOptimizer</span></code>].</p></li>
</ul>
<p>If you wanted to create an identical instance to the one created on step 2, but passing the
arguments in a explicit way, this can be achieved with the following lines:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; from tgan.model import TGANModel
&gt;&gt;&gt; tgan = TGANModel(
   ...:     continuous_columns,
   ...:     output=&#39;output&#39;,
   ...:     max_epoch=5,
   ...:     steps_per_epoch=10000,
   ...:     save_checkpoints=True,
   ...:     restore_session=True,
   ...:     batch_size=200,
   ...:     z_dim=200,
   ...:     noise=0.2,
   ...:     l2norm=0.00001,
   ...:     learning_rate=0.001,
   ...:     num_gen_rnn=100,
   ...:     num_gen_feature=100,
   ...:     num_dis_layers=1,
   ...:     num_dis_hidden=100,
   ...:     optimizer=&#39;AdamOptimizer&#39;
   ...: )
</pre></div>
</div>
</div>
</div>
<div class="section" id="command-line-interface">
<h1>Command-line interface<a class="headerlink" href="#command-line-interface" title="Permalink to this headline">¶</a></h1>
<p>We include a command-line interface that allows users to access TGAN functionality. Currently only
one action is supported.</p>
<div class="section" id="random-hyperparameter-search">
<h2>Random hyperparameter search<a class="headerlink" href="#random-hyperparameter-search" title="Permalink to this headline">¶</a></h2>
<div class="section" id="input">
<h3>Input<a class="headerlink" href="#input" title="Permalink to this headline">¶</a></h3>
<p>To run random searchs for the best model hyperparameters for a given dataset, we will need:</p>
<ul class="simple">
<li><p>A dataset, in a csv file, without any missing value, only columns of type <code class="docutils literal notranslate"><span class="pre">bool</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code> or
<code class="docutils literal notranslate"><span class="pre">float</span></code> and only one type for column, as specified in the <a class="reference external" href="#input-format">Input Format</a>.</p></li>
<li><p>A JSON file containing the configuration for the search. This configuration shall contain:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: Name of the experiment. A folder with this name will be created.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_random_search</span></code>: Number of iterations in hyper parameter search.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">train_csv</span></code>: Path to the csv file containing the dataset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">continuous_cols</span></code>: List of column indices, starting at 0, to be considered continuous.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">epoch</span></code>: Number of epoches to train the model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">steps_per_epoch</span></code>: Number of optimization steps in each epoch.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_rows</span></code>: Number of rows to sample when evaluating the model.</p></li>
</ul>
</li>
</ul>
<p>You can see an example of such a json file in <a class="reference external" href="examples/config.json">examples/config.json</a>, which you
can download and use as a template.</p>
</div>
<div class="section" id="execution">
<h3>Execution<a class="headerlink" href="#execution" title="Permalink to this headline">¶</a></h3>
<p>Once we have prepared everything we can launch the random hyperparameter search with this command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tgan experiments config.json results.json
</pre></div>
</div>
<p>Where the first argument, <code class="docutils literal notranslate"><span class="pre">config.json</span></code>, is the path to your configuration JSON, and the second,
<code class="docutils literal notranslate"><span class="pre">results.json</span></code>, is the path to store the summary of the execution.</p>
<p>This will run the random search, wich basically consist of the folling steps:</p>
<ol class="arabic simple">
<li><p>We fetch and split our data between test and train.</p></li>
<li><p>We randomly select the hyperparameters to test.</p></li>
<li><p>Then, for each hyperparameter combination, we train a TGAN model using the real training data T
and generate a synthetic training dataset Tsynth.</p></li>
<li><p>We then train machine learning models on both the real and synthetic datasets.</p></li>
<li><p>We use these trained models on real test data and see how well they perform.</p></li>
</ol>
</div>
<div class="section" id="output">
<h3>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h3>
<p>After the experiment has finished, the following can be found:</p>
<ul class="simple">
<li><p>A JSON file, in the example above called <code class="docutils literal notranslate"><span class="pre">results.json</span></code>, containing a summary of the experiments.
This JSON will contain a key for each experiment <code class="docutils literal notranslate"><span class="pre">name</span></code>, and on it, an array of length
<code class="docutils literal notranslate"><span class="pre">num_random_search</span></code>, with the selected parameters and its evaluation score. For a configuration
like the example, the summary will look like this:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;census&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;steps_per_epoch&quot;</span> <span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
            <span class="s2">&quot;num_gen_feature&quot;</span> <span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
            <span class="s2">&quot;num_dis_hidden&quot;</span> <span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
            <span class="s2">&quot;batch_size&quot;</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
            <span class="s2">&quot;num_gen_rnn&quot;</span> <span class="p">:</span> <span class="mi">400</span><span class="p">,</span>
            <span class="s2">&quot;score&quot;</span> <span class="p">:</span> <span class="mf">0.937802280415988</span><span class="p">,</span>
            <span class="s2">&quot;max_epoch&quot;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s2">&quot;num_dis_layers&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s2">&quot;learning_rate&quot;</span> <span class="p">:</span> <span class="mf">0.0002</span><span class="p">,</span>
            <span class="s2">&quot;z_dim&quot;</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
            <span class="s2">&quot;noise&quot;</span> <span class="p">:</span> <span class="mf">0.2</span>
        <span class="p">},</span>
        <span class="o">...</span> <span class="c1"># 9 more nodes</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>A set of folders, each one names after the <code class="docutils literal notranslate"><span class="pre">name</span></code> specified in the JSON configuration, contained
in the <code class="docutils literal notranslate"><span class="pre">experiments</span></code> folder. In each folder, sampled data and the models can be found. For a configuration
like the example, this will look like this:</p></li>
</ul>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>experiments/
  census/
    data/       # Sampled data with each of the models in the random search.
    model_0/
      logs/     # Training logs
      model/    # Tensorflow model checkpoints
    model_1/    # 9 more folders, one for each model in the random search
    ...
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="research">
<h1>Research<a class="headerlink" href="#research" title="Permalink to this headline">¶</a></h1>
<p>The first <strong>TGAN</strong> version was built as the supporting software for the <a class="reference external" href="https://arxiv.org/pdf/1811.11264.pdf">Synthesizing Tabular Data using Generative Adversarial Networks</a> paper by Lei Xu and Kalyan Veeramachaneni.</p>
<p>The exact version of software mentioned in the paper can be found in the releases section as the <a class="reference external" href="https://github.com/sdv-dev/TGAN/releases/tag/research">research pre-release</a></p>
</div>
<div class="section" id="what-s-next">
<h1>What’s next?<a class="headerlink" href="#what-s-next" title="Permalink to this headline">¶</a></h1>
<p>For more details about <strong>TGAN</strong> and all its possibilities and features, please check the
<a class="reference external" href="https://sdv-dev.github.io/TGAN/">project documentation site</a>!</p>
</div>
<div class="section" id="citing-tgan">
<h1>Citing TGAN<a class="headerlink" href="#citing-tgan" title="Permalink to this headline">¶</a></h1>
<p>If you use TGAN for yor research, please consider citing the following paper (<a class="reference external" href="https://arxiv.org/pdf/1811.11264.pdf">https://arxiv.org/pdf/1811.11264.pdf</a>):</p>
<p>If you use TGAN, please cite the following work:</p>
<blockquote>
<div><p>Lei Xu, Kalyan Veeramachaneni. 2018. Synthesizing Tabular Data using Generative Adversarial Networks.</p>
</div></blockquote>
<div class="highlight-LaTeX notranslate"><div class="highlight"><pre><span></span>@article<span class="nb">{</span>xu2018synthesizing,
  title=<span class="nb">{</span>Synthesizing Tabular Data using Generative Adversarial Networks<span class="nb">}</span>,
  author=<span class="nb">{</span>Xu, Lei and Veeramachaneni, Kalyan<span class="nb">}</span>,
  journal=<span class="nb">{</span>arXiv preprint arXiv:1811.11264<span class="nb">}</span>,
  year=<span class="nb">{</span>2018<span class="nb">}</span>
<span class="nb">}</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api/tgan.html" class="btn btn-neutral float-right" title="tgan package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="TGAN" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, MIT Data To AI Lab

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>